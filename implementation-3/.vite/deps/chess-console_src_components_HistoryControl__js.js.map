{
  "version": 3,
  "sources": ["../../node_modules/chess-console/src/components/HistoryControl.js"],
  "sourcesContent": ["/**\n * Author and copyright: Stefan Haack (https://shaack.com)\n * Repository: https://github.com/shaack/chess-console\n * License: MIT, see file 'LICENSE'\n */\n\nimport {Observe} from \"cm-web-modules/src/observe/Observe.js\"\nimport {COLOR} from \"cm-chessboard/src/Chessboard.js\"\n\nexport class HistoryControl {\n    constructor(chessConsole, props = {}) {\n        this.context = chessConsole.componentContainers.controlButtons\n        this.chessConsole = chessConsole\n        const i18n = chessConsole.i18n\n        this.props = {\n            autoPlayDelay: 1500\n        }\n        Object.assign(this.props, props)\n        i18n.load({\n            de: {\n                \"to_game_start\": \"Zum Spielstart\",\n                \"one_move_back\": \"Ein Zug zurÃ¼ck\",\n                \"one_move_forward\": \"Ein Zug weiter\",\n                \"to_last_move\": \"Zum letzen Zug\",\n                \"auto_run\": \"Automatisch abspielen\",\n                \"turn_board\": \"Brett drehen\"\n            },\n            en: {\n                \"to_game_start\": \"To game start\",\n                \"one_move_back\": \"One move back\",\n                \"one_move_forward\": \"One move forward\",\n                \"to_last_move\": \"To last move\",\n                \"auto_run\": \"Auto play\",\n                \"turn_board\": \"Turn board\"\n            }\n        }).then(() => {\n\n            this.$btnFirst = $(`<button type=\"button\" title=\"${i18n.t('to_game_start')}\" class=\"btn btn-link text-black first\"><i class=\"fa fa-fw fa-fast-backward\" aria-hidden=\"true\"></i></button>`)\n            this.$btnBack = $(`<button type=\"button\" title=\"${i18n.t('one_move_back')}\" class=\"btn btn-link text-black back\"><i class=\"fa fa-fw fa-step-backward\" aria-hidden=\"true\"></i></button>`)\n            this.$btnForward = $(`<button type=\"button\" title=\"${i18n.t('one_move_forward')}\" class=\"btn btn-link text-black forward\"><i class=\"fa fa-fw fa-step-forward\" aria-hidden=\"true\"></i></button>`)\n            this.$btnLast = $(`<button type=\"button\" title=\"${i18n.t('to_last_move')}\" class=\"btn btn-link text-black last\"><i class=\"fa fa-fw fa-fast-forward\" aria-hidden=\"true\"></i></button>`)\n            this.$btnAutoplay = $(`<button type=\"button\" title=\"${i18n.t('auto_run')}\" class=\"btn btn-link text-black autoplay\"><i class=\"fa fa-fw fa-play\" aria-hidden=\"true\"></i><i class=\"fa fa-fw fa-stop\" aria-hidden=\"true\"></i></button>`)\n            this.$btnOrientation = $(`<button type=\"button\" title=\"${i18n.t('turn_board')}\" class=\"btn btn-link text-black orientation\"><i class=\"fa fa-fw fa-exchange-alt fa-rotate-90\" aria-hidden=\"true\"></i></button>`)\n\n            this.context.appendChild(this.$btnFirst[0])\n            this.context.appendChild(this.$btnBack[0])\n            this.context.appendChild(this.$btnForward[0])\n            this.context.appendChild(this.$btnLast[0])\n            this.context.appendChild(this.$btnAutoplay[0])\n            this.context.appendChild(this.$btnOrientation[0])\n\n            this.chessConsole.state.observeChess(() => {\n                this.setButtonStates()\n            })\n            Observe.property(this.chessConsole.state, \"plyViewed\", () => {\n                this.setButtonStates()\n            })\n            Observe.property(this.chessConsole.state, \"orientation\", () => {\n                if (this.chessConsole.state.orientation !== this.chessConsole.props.playerColor) {\n                    this.$btnOrientation.addClass(\"btn-active\") // todo\n                } else {\n                    this.$btnOrientation.removeClass(\"btn-active\") // todo\n                }\n            })\n            this.$btnFirst.click(() => {\n                this.chessConsole.state.plyViewed = 0\n                this.resetAutoPlay()\n            })\n            this.$btnBack.click(() => {\n                this.chessConsole.state.plyViewed--\n                this.resetAutoPlay()\n            })\n            this.$btnForward.click(() => {\n                this.chessConsole.state.plyViewed++\n                this.resetAutoPlay()\n            })\n            this.$btnLast.click(() => {\n                this.chessConsole.state.plyViewed = this.chessConsole.state.chess.plyCount()\n                this.resetAutoPlay()\n            })\n            this.$btnOrientation.click(() => {\n                this.chessConsole.state.orientation = this.chessConsole.state.orientation === COLOR.white ? COLOR.black : COLOR.white\n            })\n            this.$btnAutoplay.click(() => {\n                if (this.autoplay) {\n                    clearInterval(this.autoplay)\n                    this.autoplay = null\n                } else {\n                    this.chessConsole.state.plyViewed++\n                    this.autoplay = setInterval(this.autoPlayMove.bind(this), this.props.autoPlayDelay)\n                }\n                this.updatePlayIcon()\n            })\n            document.addEventListener('keydown', (e) => {\n                if (e.metaKey || e.ctrlKey || e.altKey) {\n                    return\n                }\n                if (document.activeElement.tagName === \"INPUT\" || document.activeElement.tagName === \"TEXTAREA\") {\n                    return\n                }\n                if (e.key === \"ArrowLeft\" || e.key === \"j\") {\n                    if (this.chessConsole.state.plyViewed > 0) {\n                        this.chessConsole.state.plyViewed--\n                        this.resetAutoPlay()\n                        e.preventDefault()\n                    }\n                } else if (e.key === \"ArrowRight\" || e.key === \"k\") {\n                    if (this.chessConsole.state.plyViewed < this.chessConsole.state.chess.plyCount()) {\n                        this.chessConsole.state.plyViewed++\n                        this.resetAutoPlay()\n                        e.preventDefault()\n                    }\n                } else if (e.key === \"ArrowUp\") {\n                    this.chessConsole.state.plyViewed = 0\n                    this.resetAutoPlay()\n                    e.preventDefault()\n                } else if (e.key === \"ArrowDown\") {\n                    this.chessConsole.state.plyViewed = this.chessConsole.state.chess.plyCount()\n                    this.resetAutoPlay()\n                    e.preventDefault()\n                } else if (e.key === \"f\") {\n                    this.chessConsole.state.orientation = this.chessConsole.state.orientation === COLOR.white ? COLOR.black : COLOR.white\n                    e.preventDefault()\n                } else if (e.key === \" \") {\n                    if (this.autoplay) {\n                        clearInterval(this.autoplay)\n                        this.autoplay = null\n                    } else {\n                        if (this.chessConsole.state.plyViewed < this.chessConsole.state.chess.plyCount()) {\n                            this.chessConsole.state.plyViewed++\n                            this.autoplay = setInterval(this.autoPlayMove.bind(this), this.props.autoPlayDelay)\n                        }\n                    }\n                    this.updatePlayIcon()\n                    e.preventDefault()\n                }\n            })\n            this.setButtonStates()\n        })\n    }\n\n    resetAutoPlay() {\n        if (this.autoplay) {\n            clearInterval(this.autoplay)\n            this.autoplay = setInterval(this.autoPlayMove.bind(this), this.props.autoPlayDelay)\n        }\n    }\n\n    autoPlayMove() {\n        if (this.chessConsole.state.plyViewed >= this.chessConsole.state.chess.plyCount()) {\n            clearInterval(this.autoplay)\n            this.autoplay = null\n            this.updatePlayIcon()\n        } else {\n            this.chessConsole.state.plyViewed++\n            if (this.chessConsole.state.plyViewed >= this.chessConsole.state.chess.plyCount()) {\n                clearInterval(this.autoplay)\n                this.autoplay = null\n                this.updatePlayIcon()\n            }\n        }\n    }\n\n    updatePlayIcon() {\n        const $playIcon = this.$btnAutoplay.find(\".fa-play\")\n        const $stopIcon = this.$btnAutoplay.find(\".fa-stop\")\n        if (this.autoplay) {\n            $playIcon.hide()\n            $stopIcon.show()\n        } else {\n            $playIcon.show()\n            $stopIcon.hide()\n        }\n    }\n\n    setButtonStates() {\n        window.clearTimeout(this.redrawDebounce)\n        this.redrawDebounce = setTimeout(() => {\n            if (this.chessConsole.state.plyViewed > 0) {\n                this.$btnFirst.prop('disabled', false)\n                this.$btnBack.prop('disabled', false)\n            } else {\n                this.$btnFirst.prop('disabled', true)\n                this.$btnBack.prop('disabled', true)\n            }\n            if (this.chessConsole.state.plyViewed < this.chessConsole.state.chess.plyCount()) {\n                this.$btnLast.prop('disabled', false)\n                this.$btnForward.prop('disabled', false)\n                this.$btnAutoplay.prop('disabled', false)\n            } else {\n                this.$btnLast.prop('disabled', true)\n                this.$btnForward.prop('disabled', true)\n                this.$btnAutoplay.prop('disabled', true)\n            }\n        })\n        this.updatePlayIcon()\n    }\n}\n"],
  "mappings": "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",
  "names": []
}
