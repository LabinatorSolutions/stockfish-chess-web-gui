{
  "version": 3,
  "sources": ["../../node_modules/chess-console/src/tools/ChessRender.js", "../../node_modules/chess-console/src/components/History.js"],
  "sourcesContent": ["/**\n * Author and copyright: Stefan Haack (https://shaack.com)\n * Repository: https://github.com/shaack/cm-chess\n * License: MIT, see file 'LICENSE'\n *\n * @deprecated\n */\n\nimport {COLOR} from \"cm-chess/src/Chess.js\"\n\nexport const PIECES = {\n    notation: {\n        de: {\n            R: \"T\", N: \"S\", B: \"L\", Q: \"D\", K: \"K\", P: \"\"\n        }\n    },\n    figures: {\n        utf8: {\n            Rw: \"♖\", Nw: \"♘\", Bw: \"♗\", Qw: \"♕\", Kw: \"♔\", Pw: \"♙\",\n            Rb: \"♜\", Nb: \"♞\", Bb: \"♝\", Qb: \"♛\", Kb: \"♚\", Pb: \"♟\"\n        },\n        fontAwesomePro: {\n            Rw: '<i class=\"far fa-fw fa-chess-rook\"></i>',\n            Nw: '<i class=\"far fa-fw fa-chess-knight\"></i>',\n            Bw: '<i class=\"far fa-fw fa-chess-bishop\"></i>',\n            Qw: '<i class=\"far fa-fw fa-chess-queen\"></i>',\n            Kw: '<i class=\"far fa-fw fa-chess-king\"></i>',\n            Pw: '<i class=\"far fa-fw fa-chess-pawn\"></i>',\n            Rb: '<i class=\"fas fa-fw fa-chess-rook\"></i>',\n            Nb: '<i class=\"fas fa-fw fa-chess-knight\"></i>',\n            Bb: '<i class=\"fas fa-fw fa-chess-bishop\"></i>',\n            Qb: '<i class=\"fas fa-fw fa-chess-queen\"></i>',\n            Kb: '<i class=\"fas fa-fw fa-chess-king\"></i>',\n            Pb: '<i class=\"fas fa-fw fa-chess-pawn\"></i>'\n        }\n    }\n}\n\n// noinspection JSUnusedGlobalSymbols\nexport class ChessRender {\n    static san(san, color = COLOR.white, lang = \"en\", mode = \"text\", pieces = PIECES.figures.utf8) {\n        // console.warn(\"ChessRender is deprecated and will be removed in future\")\n        if(mode === \"figures\") {\n            if (color === COLOR.white) {\n                return this.replaceAll(san, {\n                    \"R\": pieces.Rw,\n                    \"N\": pieces.Nw,\n                    \"B\": pieces.Bw,\n                    \"Q\": pieces.Qw,\n                    \"K\": pieces.Kw\n                })\n            } else {\n                return this.replaceAll(san, {\n                    \"R\": pieces.Rb,\n                    \"N\": pieces.Nb,\n                    \"B\": pieces.Bb,\n                    \"Q\": pieces.Qb,\n                    \"K\": pieces.Kb\n                })\n            }\n        } else if(mode === \"text\") {\n            return this.replaceAll(san, PIECES.notation[lang])\n        } else {\n            console.error(\"mode must be 'text' or 'figures'\")\n        }\n    }\n    static replaceAll(str, replacementsObj, ignoreCase = false) {\n        let retStr = str\n        const flags = ignoreCase ? \"gi\" : \"g\"\n        for (let needle in replacementsObj) {\n            // noinspection JSUnfilteredForInLoop\n            retStr = retStr.replace(new RegExp(needle, flags), replacementsObj[needle])\n        }\n        return retStr\n    }\n}\n", "/**\n * Author and copyright: Stefan Haack (https://shaack.com)\n * Repository: https://github.com/shaack/chess-console\n * License: MIT, see file 'LICENSE'\n */\n\nimport {Observe} from \"cm-web-modules/src/observe/Observe.js\"\nimport {COLOR} from \"cm-chess/src/Chess.js\"\nimport {DomUtils} from \"cm-web-modules/src/utils/DomUtils.js\"\nimport {ChessRender} from \"../tools/ChessRender.js\"\n\nexport class History {\n\n    constructor(chessConsole, props) {\n        this.context = chessConsole.componentContainers.left.querySelector(\".chess-console-history\")\n        this.chessConsole = chessConsole\n        this.element = document.createElement(\"div\")\n        this.element.setAttribute(\"class\", \"history\")\n        this.context.appendChild(this.element)\n        this.props = {\n            notationType: \"figures\",\n            makeClickable: true\n        }\n        Object.assign(this.props, props)\n        this.chessConsole.state.observeChess(() => {\n            this.redraw()\n        })\n        Observe.property(chessConsole.state, \"plyViewed\", () => {\n            this.redraw()\n        })\n        if(this.props.makeClickable) {\n            this.addClickEvents()\n        }\n        this.i18n = chessConsole.i18n\n        this.i18n.load({\n            \"de\": {\n                \"game_history\": \"Spielnotation\"\n            },\n            \"en\": {\n                \"game_history\": \"Game notation\"\n            }\n        }).then(() => {\n            this.redraw()\n        })\n    }\n\n    addClickEvents() {\n        this.clickHandler = DomUtils.delegate(this.element, \"click\", \".ply\", (event) => {\n            const ply = parseInt(event.target.getAttribute(\"data-ply\"), 10)\n            if(ply <= this.chessConsole.state.chess.history().length) {\n                this.chessConsole.state.plyViewed = ply\n            }\n        })\n        this.element.classList.add(\"clickable\")\n    }\n\n    removeClickEvents() {\n        this.clickHandler.remove()\n        this.element.classList.remove(\"clickable\")\n    }\n\n    redraw() {\n        window.clearTimeout(this.redrawDebounce)\n        this.redrawDebounce = setTimeout(() => {\n            const history = this.chessConsole.state.chess.history()\n            let sanWhite\n            let sanBlack\n            let output = \"\"\n            let i\n            let rowClass = \"\"\n            let whiteClass = \"\"\n            let blackClass = \"\"\n            for (i = 0; i < history.length; i += 2) {\n                const moveWhite = history[i]\n                if (moveWhite) {\n                    sanWhite = ChessRender.san(moveWhite.san, COLOR.white, this.chessConsole.i18n.lang, this.props.notationType, this.chessConsole.props.figures)\n                }\n                const moveBlack = history[i + 1]\n                if (moveBlack) {\n                    sanBlack = ChessRender.san(moveBlack.san, COLOR.black, this.chessConsole.i18n.lang, this.props.notationType, this.chessConsole.props.figures)\n                } else {\n                    sanBlack = \"\"\n                }\n                if (this.chessConsole.state.plyViewed < i + 1) {\n                    whiteClass = \"text-muted\"\n                }\n                if(this.chessConsole.state.plyViewed === i + 1) {\n                    whiteClass = \"active\"\n                }\n                if (this.chessConsole.state.plyViewed < i + 2) {\n                    blackClass = \"text-muted\"\n                }\n                if(this.chessConsole.state.plyViewed === i + 2) {\n                    blackClass = \"active\"\n                }\n                output += \"<tr><td class='num \" + rowClass + \"'>\" + (i / 2 + 1) + \".</td><td data-ply='\" + (i + 1) + \"' class='ply \" + whiteClass + \" ply\" + (i + 1) + \"'>\" + sanWhite + \"</td><td data-ply='\" + (i + 2) + \"' class='ply \" + blackClass + \" ply\" + (i + 2) + \"'>\" + sanBlack + \"</td></tr>\"\n            }\n            this.element.innerHTML = \"<h2 class='visually-hidden'>\" + this.i18n.t(\"game_history\") + \"</h2>\" +\n                \"<table>\" + output + \"</table>\"\n            if (this.chessConsole.state.plyViewed > 0) {\n                const $ply = $(this.element).find('.ply' + this.chessConsole.state.plyViewed)\n                if ($ply.position()) {\n                    this.element.scrollTop = 0\n                    this.element.scrollTop = ($ply.position().top - 68)\n                }\n            }\n        })\n    }\n}\n"],
  "mappings": "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",
  "names": []
}
