{
  "version": 3,
  "sources": ["../../node_modules/cm-web-modules/src/i18n/I18n.js"],
  "sourcesContent": ["/**\n * Author and copyright: Stefan Haack (https://shaack.com)\n * Repository: https://github.com/shaack/cm-web-modules\n * License: MIT, see file 'LICENSE'\n */\n\nexport class I18n {\n\n    constructor(props = {}) {\n        this.props = {\n            locale: null,\n            fallbackLang: \"en\" // used, when the translation was not found for locale\n        }\n        Object.assign(this.props, props)\n        this.locale = this.props.locale\n        if (!this.locale) {\n            const htmlLang = document.documentElement.getAttribute(\"lang\")\n            if (htmlLang) {\n                this.locale = htmlLang\n            }\n            if (!this.locale) {\n                this.locale = navigator.language\n            }\n        }\n        this.lang = this.locale.substr(0, 2)\n        this.translations = {}\n    }\n\n    load(dictionary) {\n        let fetchPromises = []\n        for (const lang in dictionary) {\n            if (dictionary.hasOwnProperty(lang)) {\n                if (!this.translations[lang]) {\n                    this.translations[lang] = {}\n                }\n                const translations = dictionary[lang]\n                if (typeof translations === \"string\") {\n                    fetchPromises.push(new Promise((resolve) => {\n                        fetch(translations)\n                            .then(res => res.json())\n                            .then(json => {\n                                Object.assign(this.translations[lang], json)\n                                resolve()\n                            })\n                            .catch(err => {\n                                throw err\n                            })\n                    }))\n                } else {\n                    Object.assign(this.translations[lang], translations)\n                }\n            }\n        }\n        if(fetchPromises.length > 0) {\n            return Promise.all(fetchPromises)\n        } else {\n            return Promise.resolve()\n        }\n    }\n\n    t(code, ...values) {\n        let translation\n        if (this.translations[this.locale] && this.translations[this.locale][code]) {\n            translation = this.translations[this.locale][code]\n        } else if (this.translations[this.lang] && this.translations[this.lang][code]) {\n            translation = this.translations[this.lang][code]\n        } else if (this.translations[this.props.fallbackLang][code]) {\n            translation = this.translations[this.props.fallbackLang][code]\n        } else {\n            console.warn(\"Error, no translation found for locale:\", this.locale,\n                \", lang: \", this.lang, \", code: \", code)\n            return \"?\" + code + \"?\"\n        }\n        if (values && values.length > 0) {\n            let i = 0\n            for (const value of values) {\n                translation = translation.replace(new RegExp(\"\\\\$\" + i, \"g\"), value)\n                i++\n            }\n        }\n        return translation\n    }\n\n}\n"],
  "mappings": ";AAMO,IAAM,OAAN,MAAW;AAAA,EAEd,YAAY,QAAQ,CAAC,GAAG;AACpB,SAAK,QAAQ;AAAA,MACT,QAAQ;AAAA,MACR,cAAc;AAAA;AAAA,IAClB;AACA,WAAO,OAAO,KAAK,OAAO,KAAK;AAC/B,SAAK,SAAS,KAAK,MAAM;AACzB,QAAI,CAAC,KAAK,QAAQ;AACd,YAAM,WAAW,SAAS,gBAAgB,aAAa,MAAM;AAC7D,UAAI,UAAU;AACV,aAAK,SAAS;AAAA,MAClB;AACA,UAAI,CAAC,KAAK,QAAQ;AACd,aAAK,SAAS,UAAU;AAAA,MAC5B;AAAA,IACJ;AACA,SAAK,OAAO,KAAK,OAAO,OAAO,GAAG,CAAC;AACnC,SAAK,eAAe,CAAC;AAAA,EACzB;AAAA,EAEA,KAAK,YAAY;AACb,QAAI,gBAAgB,CAAC;AACrB,eAAW,QAAQ,YAAY;AAC3B,UAAI,WAAW,eAAe,IAAI,GAAG;AACjC,YAAI,CAAC,KAAK,aAAa,IAAI,GAAG;AAC1B,eAAK,aAAa,IAAI,IAAI,CAAC;AAAA,QAC/B;AACA,cAAM,eAAe,WAAW,IAAI;AACpC,YAAI,OAAO,iBAAiB,UAAU;AAClC,wBAAc,KAAK,IAAI,QAAQ,CAAC,YAAY;AACxC,kBAAM,YAAY,EACb,KAAK,SAAO,IAAI,KAAK,CAAC,EACtB,KAAK,UAAQ;AACV,qBAAO,OAAO,KAAK,aAAa,IAAI,GAAG,IAAI;AAC3C,sBAAQ;AAAA,YACZ,CAAC,EACA,MAAM,SAAO;AACV,oBAAM;AAAA,YACV,CAAC;AAAA,UACT,CAAC,CAAC;AAAA,QACN,OAAO;AACH,iBAAO,OAAO,KAAK,aAAa,IAAI,GAAG,YAAY;AAAA,QACvD;AAAA,MACJ;AAAA,IACJ;AACA,QAAG,cAAc,SAAS,GAAG;AACzB,aAAO,QAAQ,IAAI,aAAa;AAAA,IACpC,OAAO;AACH,aAAO,QAAQ,QAAQ;AAAA,IAC3B;AAAA,EACJ;AAAA,EAEA,EAAE,SAAS,QAAQ;AACf,QAAI;AACJ,QAAI,KAAK,aAAa,KAAK,MAAM,KAAK,KAAK,aAAa,KAAK,MAAM,EAAE,IAAI,GAAG;AACxE,oBAAc,KAAK,aAAa,KAAK,MAAM,EAAE,IAAI;AAAA,IACrD,WAAW,KAAK,aAAa,KAAK,IAAI,KAAK,KAAK,aAAa,KAAK,IAAI,EAAE,IAAI,GAAG;AAC3E,oBAAc,KAAK,aAAa,KAAK,IAAI,EAAE,IAAI;AAAA,IACnD,WAAW,KAAK,aAAa,KAAK,MAAM,YAAY,EAAE,IAAI,GAAG;AACzD,oBAAc,KAAK,aAAa,KAAK,MAAM,YAAY,EAAE,IAAI;AAAA,IACjE,OAAO;AACH,cAAQ;AAAA,QAAK;AAAA,QAA2C,KAAK;AAAA,QACzD;AAAA,QAAY,KAAK;AAAA,QAAM;AAAA,QAAY;AAAA,MAAI;AAC3C,aAAO,MAAM,OAAO;AAAA,IACxB;AACA,QAAI,UAAU,OAAO,SAAS,GAAG;AAC7B,UAAI,IAAI;AACR,iBAAW,SAAS,QAAQ;AACxB,sBAAc,YAAY,QAAQ,IAAI,OAAO,QAAQ,GAAG,GAAG,GAAG,KAAK;AACnE;AAAA,MACJ;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AAEJ;",
  "names": []
}
