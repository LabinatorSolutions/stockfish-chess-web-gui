{
  "version": 3,
  "sources": ["../../node_modules/cm-web-modules/src/message-broker/MessageBroker.js", "../../node_modules/cm-chessboard/src/extensions/accessibility/I18n.js", "../../node_modules/chess-console/src/ChessConsoleState.js", "../../node_modules/chess-console/src/ChessConsole.js"],
  "sourcesContent": ["/**\n * Author and copyright: Stefan Haack (https://shaack.com)\n * Repository: https://github.com/shaack/cm-web-modules\n * License: MIT, see file 'LICENSE'\n */\n\nexport class MessageBroker {\n\n    constructor() {\n        this.topics = []\n    }\n\n    subscribe(topic, callback) {\n        if(!topic) {\n            const message = \"subscribe: topic needed\"\n            console.error(message, callback)\n            throw new Error(message)\n        }\n        if(!callback) {\n            const message = \"subscribe: callback needed\"\n            console.error(message, topic)\n            throw new Error(message)\n        }\n        if (this.topics[topic] === undefined) {\n            this.topics[topic] = []\n        }\n        if (this.topics[topic].indexOf(callback) === -1) {\n            this.topics[topic].push(callback)\n        }\n    }\n\n    unsubscribe(topic = null, callback = null) {\n        if(callback !== null && topic !== null) {\n            this.topics[topic].splice(this.topics[topic].indexOf(callback), 1)\n        } else if (callback === null && topic !== null) {\n            this.topics[topic] = []\n        } else if (topic === null && callback !== null) {\n            for (const topicName in this.topics) {\n                // noinspection JSUnfilteredForInLoop\n                const topic = this.topics[topicName]\n                for (const topicSubscriber of topic) {\n                    if(topicSubscriber === callback) {\n                        // noinspection JSUnfilteredForInLoop\n                        this.unsubscribe(topicName, callback)\n                    }\n                }\n            }\n        } else {\n            this.topics = []\n        }\n        if(topic !== null) {\n            if(this.topics[topic] && this.topics[topic].length === 0) {\n                delete this.topics[topic]\n            }\n        }\n    }\n\n    publish(topic, object = {}, async = true) {\n        if(!topic) {\n            const message = \"publish: topic needed\"\n            console.error(message, object)\n            throw new Error(message)\n        }\n        const breadcrumbArray = topic.split(\"/\")\n        let wildcardTopic = \"\"\n        for (const topicPart of breadcrumbArray) {\n            this.callback(wildcardTopic + \"#\", topic, object, async)\n            wildcardTopic += topicPart + \"/\"\n        }\n        this.callback(topic, topic, object, async)\n    }\n\n    callback(wildcardTopic, topic, object = {}, async = true) {\n        if (this.topics[wildcardTopic]) {\n            this.topics[wildcardTopic].forEach(function (callback) {\n                if(async) {\n                    setTimeout(function () {\n                        callback(object, topic)\n                    })\n                } else {\n                    return callback(object, topic)\n                }\n            })\n        }\n    }\n\n}\n", "/**\n * Author and copyright: Stefan Haack (https://shaack.com)\n * Repository: https://github.com/shaack/cm-chessboard\n * License: MIT, see file 'LICENSE'\n */\n\nexport const piecesTranslations = {\n    en: {\n        colors: {\n            w: \"w\", b: \"b\"\n        },\n        colors_long: {\n            w: \"White\", b: \"Black\"\n        },\n        pieces: {\n            p: \"p\", n: \"n\", b: \"b\", r: \"r\", q: \"q\", k: \"k\"\n        },\n        pieces_long: {\n            p: \"Pawn\", n: \"Knight\", b: \"Bishop\", r: \"Rook\", q: \"Queen\", k: \"King\"\n        }\n    },\n    de: {\n        colors: {\n            w: \"w\", b: \"s\"\n        },\n        colors_long: {\n            w: \"Weiß\", b: \"Schwarz\"\n        },\n        pieces: {\n            p: \"b\", n: \"s\", b: \"l\", r: \"t\", q: \"d\", k: \"k\"\n        },\n        pieces_long: {\n            p: \"Bauer\", n: \"Springer\", b: \"Läufer\", r: \"Turm\", q: \"Dame\", k: \"König\"\n        }\n    }\n}\n\nexport function renderPieceTitle(lang, name, color = undefined) {\n    let title = piecesTranslations[lang].pieces_long[name]\n    if (color) {\n        title += \" \" + piecesTranslations[lang].colors_long[color]\n    }\n    return title\n}\n", "/**\n * Author and copyright: Stefan Haack (https://shaack.com)\n * Repository: https://github.com/shaack/chess-console\n * License: MIT, see file 'LICENSE'\n */\n\nimport {Observe} from \"cm-web-modules/src/observe/Observe.js\"\nimport {COLOR} from \"cm-chessboard/src/Chessboard.js\"\nimport {Chess} from \"cm-chess/src/Chess.js\"\n\nexport class ChessConsoleState {\n\n    constructor(props) {\n        this.chess = new Chess() // used to validate moves and keep the history\n        this.orientation = props.playerColor || COLOR.white\n        this.plyViewed = undefined // the play viewed on the board\n    }\n\n    observeChess(callback) {\n        const chessManipulationMethods = [\n            'move', 'clear', 'load', 'loadPgn', 'put', 'remove', 'reset', 'undo'\n        ]\n        chessManipulationMethods.forEach((methodName) => {\n            Observe.postFunction(this.chess, methodName, (params) => {\n                callback(params)\n            })\n        })\n    }\n\n}\n", "/**\n * Author and copyright: Stefan Haack (https://shaack.com)\n * Repository: https://github.com/shaack/chess-console\n * License: MIT, see file 'LICENSE'\n */\n\nimport {FEN, GAME_VARIANT} from \"cm-chess/src/Chess.js\"\nimport {COLOR} from \"cm-chessboard/src/Chessboard.js\"\nimport {I18n} from \"cm-web-modules/src/i18n/I18n.js\"\nimport {MessageBroker} from \"cm-web-modules/src/message-broker/MessageBroker.js\"\nimport {piecesTranslations} from \"cm-chessboard/src/extensions/accessibility/I18n.js\"\nimport {ChessConsoleState} from \"./ChessConsoleState.js\"\nimport {DomUtils} from \"cm-web-modules/src/utils/DomUtils.js\"\n\nexport const CONSOLE_MESSAGE_TOPICS = {\n    newGame: \"game/new\", // if a new game was startet\n    initGame: \"game/init\", // after a page reload and when a new game was started\n    gameOver: \"game/over\",\n    moveRequest: \"game/moveRequest\",\n    legalMove: \"game/move/legal\",\n    illegalMove: \"game/move/illegal\",\n    moveUndone: \"game/move/undone\", // mainly for sound\n    load: \"game/load\"\n}\n\nexport class ChessConsole {\n\n    constructor(context, player, opponent, props = {},\n                state = new ChessConsoleState(props)) {\n        this.context = context\n        this.state = state\n        this.props = {\n            locale: navigator.language, // locale for i18n\n            playerColor: COLOR.white, // the players color (color at bottom)\n            gameVariant: GAME_VARIANT.standard,\n            pgn: undefined, // initial pgn, can contain header and history\n            accessible: false // render additional information to improve the usage for persons using screen readers\n        }\n        if (!this.props.figures) {\n            this.props.figures = {\n                Rw: '<i class=\"fas fa-fw fa-chess-rook fa-figure-white\"></i>',\n                Nw: '<i class=\"fas fa-fw fa-chess-knight fa-figure-white\"></i>',\n                Bw: '<i class=\"fas fa-fw fa-chess-bishop fa-figure-white\"></i>',\n                Qw: '<i class=\"fas fa-fw fa-chess-queen fa-figure-white\"></i>',\n                Kw: '<i class=\"fas fa-fw fa-chess-king fa-figure-white\"></i>',\n                Pw: '<i class=\"fas fa-fw fa-chess-pawn fa-figure-white\"></i>',\n                Rb: '<i class=\"fas fa-fw fa-chess-rook fa-figure-black\"></i>',\n                Nb: '<i class=\"fas fa-fw fa-chess-knight fa-figure-black\"></i>',\n                Bb: '<i class=\"fas fa-fw fa-chess-bishop fa-figure-black\"></i>',\n                Qb: '<i class=\"fas fa-fw fa-chess-queen fa-figure-black\"></i>',\n                Kb: '<i class=\"fas fa-fw fa-chess-king fa-figure-black\"></i>',\n                Pb: '<i class=\"fas fa-fw fa-chess-pawn fa-figure-black\"></i>'\n            }\n        }\n        const colSets = {\n            consoleGame: \"col-xl-7 order-xl-2 col-lg-8 order-lg-1 order-md-1 col-md-12\",\n            consoleRight: \"col-xl-3 order-xl-3 col-lg-4 order-lg-2 col-md-8 order-md-3\",\n            consoleLeft: \"col-xl-2 order-xl-1 order-lg-3 col-lg-12 col-md-4 order-md-2\"\n        }\n        this.initialized = new Promise((resolve => {\n            this.i18n = new I18n({locale: props.locale})\n            this.i18n.load({\n                de: {\n                    ok: \"OK\",\n                    cancel: \"Abbrechen\",\n                },\n                en: {\n                    ok: \"OK\",\n                    cancel: \"Cancel\",\n                }\n            }).then(() => {\n                this.i18n.load(piecesTranslations).then(() => {\n                    resolve(this)\n                })\n            })\n        }))\n        /**\n         * @deprecated 2023-04-11 use this.initialized instead\n         */\n        this.initialization = this.initialized\n        if (!this.props.template) {\n            this.props.template = `\n                <div class=\"row chess-console\">\n                    <div class=\"chess-console-center ${colSets.consoleGame}\">\n                        <div class=\"chess-console-board\"></div>\n                    </div>\n                    <div class=\"chess-console-right ${colSets.consoleRight}\">\n                        <div class=\"control-buttons buttons-grid mb-4\"></div>\n                        <div class=\"chess-console-notifications\"></div>\n                    </div>\n                    <div class=\"chess-console-left ${colSets.consoleLeft}\">\n                        <div class=\"row\">\n                            <div class=\"col-xl-12 col-lg-4 col-md-12 col-6\">\n                                <div class=\"chess-console-history\"></div>\n                            </div>\n                            <div class=\"col-xl-12 col-lg-8 col-md-12 col-6\">\n                                <div class=\"chess-console-captured\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>`\n        }\n        Object.assign(this.props, props)\n        this.messageBroker = new MessageBroker()\n        const innerHTMLElement = DomUtils.createElement(this.context.innerHTML)\n        if (!(innerHTMLElement instanceof Element) ||\n            (!innerHTMLElement.querySelector(\".chess-console\") &&\n                !innerHTMLElement.classList.contains(\"chess-console\"))) {\n            this.context.innerHTML = this.props.template\n        }\n        this.componentContainers = {\n            center: this.context.querySelector(\".chess-console-center\"),\n            left: this.context.querySelector(\".chess-console-left\"),\n            right: this.context.querySelector(\".chess-console-right\"),\n            board: this.context.querySelector(\".chess-console-board\"),\n            controlButtons: this.context.querySelector(\".control-buttons\"),\n            notifications: this.context.querySelector(\".chess-console-notifications\")\n        }\n        this.components = {\n            // put here components, which want to be accessible from other components\n        }\n        this.player = new player.type(this, player.name, player.props)\n        this.opponent = new opponent.type(this, opponent.name, opponent.props)\n\n        /** @var this.persistence Persistence */\n        this.persistence = undefined\n    }\n\n    initGame(props = {}, requestNextMove = true) {\n        Object.assign(this.props, props)\n        this.state.orientation = this.props.playerColor\n        if (props.pgn) {\n            this.state.chess.loadPgn(props.pgn, true)\n            this.props.gameVariant = this.state.chess.props.gameVariant\n            this.state.plyViewed = this.state.chess.plyCount()\n        } else {\n            this.state.chess.load(FEN.start)\n            this.state.plyViewed = 0\n        }\n        if (requestNextMove) {\n            this.nextMove()\n        }\n        this.messageBroker.publish(CONSOLE_MESSAGE_TOPICS.initGame, {props: props})\n    }\n\n    newGame(props = {}) {\n        this.messageBroker.publish(CONSOLE_MESSAGE_TOPICS.newGame, {props: props})\n        this.initGame(props)\n        if (this.components.board.chessboard) {\n            this.components.board.chessboard.disableMoveInput()\n        }\n    }\n\n    playerWhite() {\n        return this.props.playerColor === COLOR.white ? this.player : this.opponent\n    }\n\n    playerBlack() {\n        return this.props.playerColor === COLOR.white ? this.opponent : this.player\n    }\n\n    playerToMove() {\n        if (this.state.chess.gameOver()) {\n            return null\n        } else {\n            if (this.state.chess.turn() === \"w\") {\n                return this.playerWhite()\n            } else {\n                return this.playerBlack()\n            }\n        }\n    }\n\n    /*\n     * - calls `moveRequest()` in next player\n     */\n    nextMove() {\n        const playerToMove = this.playerToMove()\n        if (playerToMove) {\n            this.messageBroker.publish(CONSOLE_MESSAGE_TOPICS.moveRequest, {playerToMove: playerToMove})\n            setTimeout(() => {\n                playerToMove.moveRequest(this.state.chess.fen(), (move) => {\n                    return this.handleMoveResponse(move)\n                })\n            })\n        }\n    }\n\n    /*\n     * - validates move\n     * - requests nextMove\n     */\n    handleMoveResponse(move) {\n        const playerMoved = this.playerToMove()\n        const moveResult = this.state.chess.move(move)\n        if (!moveResult) {\n            if (this.props.debug) {\n                console.warn(\"illegalMove\", this.state.chess, move)\n            }\n            this.messageBroker.publish(CONSOLE_MESSAGE_TOPICS.illegalMove, {\n                playerMoved: playerMoved,\n                move: move\n            })\n            return moveResult\n        }\n        if (this.state.plyViewed === this.state.chess.plyCount() - 1) {\n            this.state.plyViewed++\n        }\n        this.messageBroker.publish(CONSOLE_MESSAGE_TOPICS.legalMove, {\n            playerMoved: playerMoved,\n            move: move,\n            moveResult: moveResult\n        })\n        if (!this.state.chess.gameOver()) {\n            this.nextMove()\n        } else {\n            let wonColor = null\n            if (this.state.chess.inCheckmate()) {\n                wonColor = (this.state.chess.turn() === COLOR.white) ? COLOR.black : COLOR.white\n            }\n            this.messageBroker.publish(CONSOLE_MESSAGE_TOPICS.gameOver, {wonColor: wonColor})\n        }\n        return moveResult\n    }\n\n    undoMove() {\n        this.components.board.chessboard.disableMoveInput()\n        this.state.chess.undo()\n        if (this.playerToMove() !== this.player) {\n            this.state.chess.undo()\n        }\n        if (this.state.plyViewed > this.state.chess.plyCount()) {\n            this.state.plyViewed = this.state.chess.plyCount()\n        }\n        this.messageBroker.publish(CONSOLE_MESSAGE_TOPICS.moveUndone)\n        this.nextMove()\n    }\n\n}\n"],
  "mappings": "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",
  "names": ["topic"]
}
