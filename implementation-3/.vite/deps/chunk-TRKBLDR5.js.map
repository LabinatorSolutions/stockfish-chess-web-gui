{
  "version": 3,
  "sources": ["../../node_modules/cm-web-modules/src/utils/DomUtils.js"],
  "sourcesContent": ["/**\n * Author and copyright: Stefan Haack (https://shaack.com)\n * Repository: https://github.com/shaack/cm-web-modules\n * License: MIT, see file 'LICENSE'\n */\n\nexport class DomUtils {\n\n    static onDocumentReady(callback) {\n        this.documentReady(callback)\n    }\n\n    /** @deprecated 2023-05-31 use onDocumentReady() */\n    static documentReady(callback) {\n        document.addEventListener(\"DOMContentLoaded\", callback)\n        if (document.readyState === \"interactive\" || document.readyState === \"complete\") {\n            document.removeEventListener(\"DOMContentLoaded\", callback)\n            callback()\n        }\n    }\n\n    // todo test, if it works with document.body\n    static onDomNodeRemoved(elementToWatch, callback, parent = document.querySelector('body')) {\n        const observer = new MutationObserver(function (mutations) {\n            mutations.forEach(function (mutation) {\n                if (mutation.type === 'childList') {\n                    if (mutation.removedNodes.length > 0 && mutation.removedNodes[0] === elementToWatch) {\n                        callback(elementToWatch)\n                    }\n                }\n            })\n        })\n        observer.observe(parent, {childList: true})\n    };\n\n    // https://stackoverflow.com/questions/19669786/check-if-element-is-visible-in-dom\n    static isElementVisible(element) {\n        return !!(element.offsetWidth || element.offsetHeight || element.getClientRects().length)\n    }\n\n    // https://stackoverflow.com/questions/123999/how-can-i-tell-if-a-dom-element-is-visible-in-the-current-viewport\n    static isElementInViewport(element) {\n        const rect = element.getBoundingClientRect()\n        return (\n            rect.top >= 0 &&\n            rect.left >= 0 &&\n            rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n            rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n        )\n    }\n\n    static getFormInputValues(context) {\n        const inputs = context.querySelectorAll(\"input,select\")\n        const values = {}\n        inputs.forEach((input) => {\n            if (input.type === \"checkbox\") {\n                values[input.id] = !!input.checked\n            } else {\n                values[input.id] = input.value\n            }\n        })\n        return values\n    }\n\n    static isBrowserDarkMode() {\n        return !!(window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches)\n    }\n\n    static browserSupportsPreferredColorScheme() {\n        return window.matchMedia &&\n            (window.matchMedia(\"(prefers-color-scheme: dark)\").matches ||\n                window.matchMedia(\"(prefers-color-scheme: light)\").matches)\n    }\n\n    static loadJs(src) {\n        const element = document.createElement(\"script\")\n        element.setAttribute(\"type\", \"text/javascript\")\n        element.setAttribute(\"src\", src)\n        document.getElementsByTagName(\"head\")[0].appendChild(element)\n    }\n\n    static loadCss(src) {\n        const element = document.createElement(\"link\")\n        element.setAttribute(\"rel\", \"stylesheet\")\n        element.setAttribute(\"type\", \"text/css\")\n        element.setAttribute(\"href\", src)\n        document.getElementsByTagName(\"head\")[0].appendChild(element)\n    }\n\n    static setCustomProperty(name, value, element = document.documentElement) {\n        element.style.setProperty(\"--\" + name, value.trim())\n    }\n\n    static getCustomProperty(name, element = document.documentElement) {\n        return getComputedStyle(element).getPropertyValue(\"--\" + name).trim()\n    }\n\n    static createElement(html) {\n        const template = document.createElement(\"template\")\n        template.innerHTML = html.trim()\n        return template.content.firstChild\n    }\n\n    static removeElement(element) {\n        element.parentNode.removeChild(element)\n    }\n\n    static clearElement(element) {\n        while (element.firstChild) {\n            element.removeChild(element.firstChild)\n        }\n    }\n\n    static insertAfter(newChild, refChild) {\n        refChild.parentNode.insertBefore(newChild, refChild.nextSibling)\n    }\n\n    static delegate(element, eventName, selector, handler) {\n        const eventListener = function (event) {\n            let target = event.target\n            while (target && target !== this) {\n                if (target.matches(selector)) {\n                    handler.call(target, event)\n                }\n                target = target.parentNode\n            }\n        }\n        element.addEventListener(eventName, eventListener)\n        return {\n            remove: function () {\n                element.removeEventListener(eventName, eventListener)\n            }\n        }\n    }\n\n    static isExternalLink(link) {\n        return link.hostname !== window.location.hostname;\n    }\n\n    static openExternalLinksBlank(context = document) {\n        const links = context.links\n        for (let i = 0; i < links.length; i++) {\n            if (this.isExternalLink(links[i]) && links[i].target !== \"_self\") {\n                links[i].target = \"_blank\"\n            }\n        }\n    }\n\n    static disableButtonsOnSubmit() {\n        const buttons = document.querySelectorAll(\"button[data-disable-on-submit]\")\n        buttons.forEach((button) => {\n            button.addEventListener(\"click\", () => {\n                button.setAttribute(\"disabled\", \"disabled\")\n            })\n        })\n    }\n\n    /**\n     * Searches for \"data-event-listener\" attributes in the HTML, and couples them with actions.\n     * Tag Attributes:\n     *  - `data-event-listener`: The event \"click\", \"change\",...\n     *  - `data-action`: The action in this.actions, called on the event\n     *  - `data-delegate`: Query selector, to delegate the event from a child element\n     */\n    static autoBindDataEvents(controller, props = {}) {\n        const context = controller.context\n        const eventListenerElements = context.querySelectorAll(\"[data-event]\")\n        this.props = {\n            debug: false,\n            ...props\n        }\n        if (this.props.debug) {\n            console.log(\"eventListenerElements\", context, eventListenerElements)\n        }\n        for (const eventListenerElement of eventListenerElements) {\n            const eventName = eventListenerElement.dataset.event\n            const action = eventListenerElement.dataset.action\n            const delegate = eventListenerElement.dataset.delegate\n            if(!action) {\n                console.error(\"no action defined\", eventListenerElement)\n            }\n            if (!controller.actions[action]) {\n                console.error(context, \"You have to add the action \\\"\" + action + \"\\\" to your component.\")\n            }\n            if (delegate) {\n                DomUtils.delegate(eventListenerElement, eventName, delegate, (target) => {\n                    if (this.props.debug) {\n                        console.log(\"delegate\", action, target)\n                    }\n                    controller.actions[action](target)\n                })\n            } else {\n                if (this.props.debug) {\n                    console.log(\"addEventListener\", eventName, action)\n                }\n                if (!controller.actions[action]) {\n                    console.error(\"no action\", \"\\\"\" + action + \"\\\"\", \"is defined\")\n                } else {\n                    eventListenerElement.addEventListener(eventName, controller.actions[action].bind(controller))\n                }\n            }\n        }\n    }\n\n}\n"],
  "mappings": "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",
  "names": []
}
